(this["webpackJsonpinstagram-react12"]=this["webpackJsonpinstagram-react12"]||[]).push([[3],{325:function(e,t,n){"use strict";function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function s(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function i(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e,t,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(a){var r=Object.getOwnPropertyDescriptor(a,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var p=n(0),m=n(326),d=m.canvasStyle,f=m.mirrorProps,v=n(327).omit;function h(e,t){if("letters"!==t&&"words"!==t)throw new Error("Unsupported options basedOn: ".concat(t));if(e.nodeType===Node.TEXT_NODE){var n,a=document.createDocumentFragment();switch(t){case"words":n=e.textContent.split(/\b|(?=\W)/);break;case"letters":n=Array.from(e.textContent)}n.forEach((function(e){a.appendChild(function(e){var t=document.createElement("span");return t.className="LinesEllipsis-unit",t.textContent=e,t}(e))})),e.parentNode.replaceChild(a,e)}else if(e.nodeType===Node.ELEMENT_NODE)for(var r=[].slice.call(e.childNodes),o=r.length,s=0;s<o;s++)h(r[s],t)}function b(e){e.parentNode.replaceChild(document.createTextNode(e.textContent),e)}function y(e,t){if(t.contains(e)&&e!==t){for(;e.nextElementSibling;)e.parentNode.removeChild(e.nextElementSibling);y(e.parentNode,t)}}function g(e){for(var t=e;t=t.parentNode;)if(/p|div|main|section|h\d|ul|ol|li/.test(t.tagName.toLowerCase()))return t}function E(e){return!(!e.offsetHeight||!e.offsetWidth&&!/\S/.test(e.textContent))}var O={component:"div",unsafeHTML:"",maxLine:1,ellipsis:"\u2026",ellipsisHTML:void 0,className:"",basedOn:void 0,onReflow:function(){},winWidth:void 0},j=Object.keys(O),w=function(e){function t(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=i(this,l(t).call(this,e))).state={html:e.unsafeHTML,clamped:!1},n.canvas=null,n.maxLine=0,n.nlUnits=[],n}var n,a,m;return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(t,e),n=t,(a=[{key:"componentDidMount",value:function(){this.initCanvas(),this.reflow(this.props)}},{key:"componentDidUpdate",value:function(e){e.winWidth!==this.props.winWidth&&this.copyStyleToCanvas(),this.props!==e&&this.reflow(this.props)}},{key:"componentWillUnmount",value:function(){this.canvas.parentNode.removeChild(this.canvas)}},{key:"setState",value:function(e,n){return"undefined"!==typeof e.clamped&&(this.clamped=e.clamped),c(l(t.prototype),"setState",this).call(this,e,n)}},{key:"initCanvas",value:function(){if(!this.canvas){var e=this.canvas=document.createElement("div");e.className="LinesEllipsis-canvas ".concat(this.props.className),e.setAttribute("aria-hidden","true"),this.copyStyleToCanvas(),Object.keys(d).forEach((function(t){e.style[t]=d[t]})),document.body.appendChild(e)}}},{key:"copyStyleToCanvas",value:function(){var e=this,t=window.getComputedStyle(this.target);f.forEach((function(n){e.canvas.style[n]=t[n]}))}},{key:"reflow",value:function(e){this.maxLine=+e.maxLine||1,this.canvas.innerHTML=e.unsafeHTML;var t=e.basedOn||(/^[\x00-\x7F]+$/.test(e.unsafeHTML)?"words":"letters");h(this.canvas,t);var n={clamped:this.putEllipsis(this.calcIndexes()),html:this.canvas.innerHTML};this.setState(n,e.onReflow.bind(this,n))}},{key:"calcIndexes",value:function(){var e=[0],t=this.nlUnits=Array.from(this.canvas.querySelectorAll(".LinesEllipsis-unit")),n=t.length;if(!t.length)return e;var a=t.find(E);if(!a)return e;for(var r=1,o=a.offsetTop,s=1;s<n&&!(E(t[s])&&t[s].offsetTop-o>1&&(r++,e.push(s),o=t[s].offsetTop,r>this.maxLine));s++);return e}},{key:"putEllipsis",value:function(e){if(e.length<=this.maxLine)return!1;this.nlUnits=this.nlUnits.slice(0,e[this.maxLine]);var t=this.nlUnits.pop(),n=this.makeEllipsisSpan();do{y(t,this.canvas),g(t).appendChild(n),t=this.nlUnits.pop()}while(t&&(!E(t)||n.offsetHeight>t.offsetHeight||n.offsetTop>t.offsetTop));return t&&b(t),this.nlUnits.forEach(b),!0}},{key:"makeEllipsisSpan",value:function(){var e=this.props,t=e.ellipsisHTML,n=e.ellipsis,a=document.createElement("span");a.appendChild(document.createElement("wbr"));var r=document.createElement("span");return r.className="LinesEllipsis-ellipsis",t?r.innerHTML=t:r.textContent=n,a.appendChild(r),a}},{key:"isClamped",value:function(){return this.clamped}},{key:"render",value:function(){var e=this,t=this.state,n=t.html,a=t.clamped,s=this.props,i=s.component,c=s.className,l=s.unsafeHTML,u=o(s,["component","className","unsafeHTML"]);return p.createElement(i,r({className:"LinesEllipsis ".concat(a?"LinesEllipsis--clamped":""," ").concat(c),ref:function(t){return e.target=t}},v(u,j)),p.createElement("div",{dangerouslySetInnerHTML:{__html:a?n:l}}))}}])&&s(n.prototype,a),m&&s(n,m),t}(p.Component);w.defaultProps=O,e.exports=w},326:function(e,t,n){"use strict";e.exports={canvasStyle:{position:"absolute",bottom:0,left:0,height:0,overflow:"hidden","padding-top":0,"padding-bottom":0,border:"none"},mirrorProps:["box-sizing","width","font-size","font-weight","font-family","font-style","letter-spacing","text-indent","white-space","word-break","overflow-wrap","padding-left","padding-right"]}},327:function(e,t,n){"use strict";function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports={omit:function(e,t){if(!e||"object"!==a(e))return e;var n={};return Object.keys(e).forEach((function(a){t.indexOf(a)>-1||(n[a]=e[a])})),n}}},328:function(e,t,n){"use strict";n.r(t);var a=n(19),r=n(37),o=n(3),s=n(24),i=n(0),c=n.n(i),l=n(12),u=n(83),p=n(23),m=n(46),d=n(80),f=n(322),v=n(111),h=n(320),b=n(325),y=n.n(b),g=n(140),E=n(144),O=n(76),j=n(145),w=n.n(j),k=n(30),_=n(34),N=n(15),x=n(64);var C=function(e){var t=e.likes,n=e.postId,a=e.authorId,i=Object(l.i)(),u=c.a.useContext(x.a),p=u.currentUserId,m=u.feedIds,d=u.me,f=t.some((function(e){return e.user_id===p})),v=c.a.useState(f),h=Object(o.a)(v,2),b=h[0],y=h[1],g=b?s.s:s.k,E=b?i.liked:i.like,O=Object(N.c)(k.i),j=Object(o.a)(O,1)[0],w=Object(N.c)(k.l),C=Object(o.a)(w,1)[0],S={postId:n,userId:p,profileId:a};function I(e,t){var n,a={limit:2,feedIds:m,lastTimestamp:d.created_at},o=e.readQuery({query:_.d,variables:a}),s="default_likes_mutation_response"===(null===(n=t.data.insert_default_likes)||void 0===n?void 0:n.__typename)?1:-1,i=o.default_posts.map((function(e){return Object(r.a)({},e,{likes_aggregate:Object(r.a)({},e.likes_aggregate,{aggregate:Object(r.a)({},e.likes_aggregate.aggregate,{count:e.likes_aggregate.aggregate.count+s})})})}));e.writeQuery({query:_.d,data:{default_posts:i}})}var T=b?function(){y(!1),C({variables:S,update:I})}:function(){y(!0),j({variables:S,update:I})};return c.a.createElement(g,{className:E,onClick:T})},S=function(e){var t=e.savedPosts,n=e.postId,a=Object(l.i)(),r=c.a.useContext(x.a).currentUserId,i=t.some((function(e){return e.user_id===r})),u=c.a.useState(i),p=Object(o.a)(u,2),m=p[0],d=p[1],f=m?s.p:s.q,v=Object(N.c)(k.j),h=Object(o.a)(v,1)[0],b=Object(N.c)(k.m),y=Object(o.a)(b,1)[0],g={postId:n,userId:r},E=m?function(){d(!1),y({variables:g})}:function(){d(!0),h({variables:g})};return c.a.createElement(f,{className:a.saveIcon,onClick:E})},I=function(e){var t=e.postId,n=Object(l.i)(),s=c.a.useContext(x.a),i=s.currentUserId,u=s.feedIds,p=s.me,m=Object(N.c)(k.b),f=Object(o.a)(m,1)[0];function v(e,n){var o={limit:2,feedIds:u,lastTimestamp:p.created_at},s=e.readQuery({query:_.d,variables:o}),i=n.data.insert_default_comments.returning[0],c=Object(r.a)({},i,{user:Object(r.a)({},i.user)}),l=s.default_posts.map((function(e){var n=Object(r.a)({},e,{comments:[].concat(Object(a.a)(e.comments),[c]),comments_aggregate:Object(r.a)({},e.comments_aggregate,{aggregate:Object(r.a)({},e.comments_aggregate.aggregate,{count:e.comments_aggregate.aggregate.count+1})})});return e.id===t?n:e}));e.writeQuery({query:_.d,data:{default_posts:l}}),E("")}var b=c.a.useState(""),y=Object(o.a)(b,2),g=y[0],E=y[1];return c.a.createElement("div",{className:n.commentContainer},c.a.createElement(h.a,{fullWidth:!0,vlaue:g,placeholder:"Add a comment...",multiline:!0,rowsMax:2,rows:1,onChange:function(e){return E(e.target.value)},className:n.textField,InputProps:{classes:{root:n.root,underline:n.underline}}}),c.a.createElement(d.a,{onClick:function(){f({variables:{content:g,postId:t,userId:i},update:v})},color:"primary",className:n.commentButton,disabled:!g.trim()},"Post"))};t.default=function(e){var t=e.post,n=e.index,a=Object(l.i)(),r=c.a.useState(!1),i=Object(o.a)(r,2),h=i[0],b=i[1],j=c.a.useState(!1),k=Object(o.a)(j,2),_=k[0],N=k[1],x=t.media,T=t.id,L=t.likes,H=t.likes_aggregate,M=t.default_user,P=t.caption,U=t.comments,W=t.saved_posts,D=t.location,q=t.comments_aggregate,R=t.created_at,A=1===n,B=H.aggregate.count,F=q.aggregate.count;return c.a.createElement(c.a.Fragment,null,c.a.createElement("article",{className:a.article,style:{marginBottom:A&&30}},c.a.createElement("div",{className:a.postHeader},c.a.createElement(u.a,{location:D,user:M}),c.a.createElement(s.o,{className:a.MoreIcon,onClick:function(){N(!0)}})),c.a.createElement("div",null,c.a.createElement(w.a,{src:x,alt:"post media",className:a.image})),c.a.createElement("div",{className:a.postButtonsWrapper},c.a.createElement("div",{className:a.postButtons},c.a.createElement(C,{likes:L,postId:T,authorId:M.id}),c.a.createElement(p.b,{to:"/p/".concat(T)}),c.a.createElement(s.c,null),c.a.createElement(s.r,null),c.a.createElement(S,{savedPosts:W,postId:T})),c.a.createElement(m.a,{className:a.likes,variant:"subtitle2"},c.a.createElement("span",null,1===B?"1 like":"".concat(B," likes"))),c.a.createElement("div",{className:h?a.expended:a.collapsed},c.a.createElement(p.b,{to:"/".concat(M.username)},c.a.createElement(m.a,{variant:"subtitle2",component:"span",className:a.username},M.username)),h?c.a.createElement(m.a,{variant:"body2",component:"span",dangerouslySetInnerHTML:{__html:P}}):c.a.createElement("div",{className:a.captionWrapper},c.a.createElement(y.a,{unsafeHTML:P,className:a.caption,maxLine:"0",ellipsis:"...",basedOn:"letters"}),c.a.createElement(d.a,{className:a.moreButton,onClick:function(){return b(!0)}},"more"))),c.a.createElement(p.b,{to:"/p/".concat(T)},c.a.createElement(m.a,{className:a.commentsLink,variant:"body2",component:"div"},"View all ",F," comments")),U.map((function(e){return c.a.createElement("div",{key:e.id},c.a.createElement(p.b,{to:"/".concat(e.user.username)},c.a.createElement(m.a,{variant:"subtitle2",component:"span",className:a.componentUsername},e.user.username)," ",c.a.createElement(m.a,{variant:"body2",component:"span"},e.content)))})),c.a.createElement(m.a,{color:"textSecondary",className:a.dataPosted},Object(O.a)(R))),c.a.createElement(f.a,{xsDown:!0},c.a.createElement(v.a,null),c.a.createElement(I,{postId:T}))),A&&c.a.createElement(g.a,null),_&&c.a.createElement(E.a,{authorId:M.id,postId:T,onClose:function(){return N(!1)}}))}}}]);
//# sourceMappingURL=3.0e641062.chunk.js.map